<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>インデント式プレビューエディタ</title>

  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }

    .section {
      margin-bottom: 30px;
    }

    .label {
      color: royalblue;
      font-weight: bold;
      margin-bottom: 6px;
    }

    textarea.editor {
      width: 100%;
      min-height: 200px;
      padding: 10px;
      box-sizing: border-box;
      font-size: 1rem;
      line-height: 1.8em;
      font-family: inherit;
      resize: vertical;
    }

    .preview {
      margin-top: 10px;
      background: #f9f9f9;
      padding: 10px;
      min-height: 200px;
      white-space: pre-wrap;
      line-height: 1.8em;
      font-size: 1rem;
      font-family: inherit;
      border: 1px solid #ddd;
    }

    h1 {
      font-size: 1.4rem;
      margin: 0.5em 0 0.3em;
    }

    h2 {
      font-size: 1.2rem;
      margin: 0.4em 0 0.2em;
    }

    h3 {
      font-size: 1.1rem;
      margin: 0.3em 0 0.2em;
    }

    p {
      margin: 0.2em 0;
    }
  </style>
</head>
<body>

  <div class="section">
    <p class="label">info</p>
    <textarea class="editor" placeholder="ここに入力..."></textarea>
    <div class="preview"></div>
  </div>

  <div class="section">
    <p class="label">main</p>
    <textarea class="editor" placeholder="ここに入力..."></textarea>
    <div class="preview"></div>
  </div>

  <div class="section">
    <p class="label">etc</p>
    <textarea class="editor" placeholder="ここに入力..."></textarea>
    <div class="preview"></div>
  </div>

  <script>
    document.querySelectorAll(".section").forEach(section => {
      const ta = section.querySelector(".editor");
      const preview = section.querySelector(".preview");

      ta.addEventListener("input", () => {
        preview.innerHTML = convertTextToHtml(ta.value);
      });

      // 初期描画
      ta.dispatchEvent(new Event("input"));
    });

    function convertTextToHtml(text) {
      const lines = text.split("\n");
      let html = "";

      lines.forEach(line => {
        const indent = (line.match(/^[ 　]*/) || [""])[0].length;
        const content = line.trim();

        if (!content) {
          html += "<br>";
          return;
        }

        if (indent === 0) html += `<h1>${content}</h1>`;
        else if (indent === 1) html += `<h2>${content}</h2>`;
        else if (indent === 2) html += `<h3>${content}</h3>`;
        else {
          const margin = (indent - 2) * 20;
          html += `<p style="margin-left:${margin}px">${content}</p>`;
        }
      });

      return html;
    }
  </script>
</body>
</html>